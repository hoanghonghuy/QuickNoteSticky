<Window x:Class="DevSticky.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:loc="clr-namespace:DevSticky.Services"
        Title="{loc:Localize SettingsTitle}"
        Width="380" Height="480"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/SharedStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <Border Background="{DynamicResource BaseBrush}" CornerRadius="8" 
            BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="60"/>
            </Grid.RowDefinitions>
            
            <!-- Header -->
            <Border Grid.Row="0" Background="{DynamicResource Surface0Brush}" 
                    CornerRadius="8,8,0,0" MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Grid Margin="12,0">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="â˜° " Foreground="{DynamicResource TextBrush}" FontSize="14"/>
                        <TextBlock Text="{loc:Localize SettingsTitle}" Foreground="{DynamicResource TextBrush}" 
                                   FontSize="14" FontWeight="SemiBold"/>
                    </StackPanel>
                    <Button Content="âœ•" Style="{StaticResource IconBtn}" 
                            HorizontalAlignment="Right" Click="BtnClose_Click"/>
                </Grid>
            </Border>
            
            <!-- Settings Content -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="16">
                <StackPanel>
                    <!-- Default Opacity -->
                    <TextBlock Style="{StaticResource SettingLabel}">
                        <Run Text="{loc:Localize DefaultOpacity}"/>
                        <Run Text=": "/>
                        <Run x:Name="OpacityValue" Text="0.9"/>
                    </TextBlock>
                    <Slider x:Name="OpacitySlider" Style="{StaticResource SettingSlider}"
                            Minimum="0.2" Maximum="1.0" Value="0.9"
                            ValueChanged="OpacitySlider_ValueChanged"/>
                    
                    <!-- Font Size -->
                    <TextBlock Style="{StaticResource SettingLabel}">
                        <Run Text="{loc:Localize FontSize}"/>
                        <Run Text=": "/>
                        <Run x:Name="FontSizeValue" Text="13"/>
                    </TextBlock>
                    <Slider x:Name="FontSizeSlider" Style="{StaticResource SettingSlider}"
                            Minimum="10" Maximum="24" Value="13"
                            ValueChanged="FontSizeSlider_ValueChanged"
                            IsSnapToTickEnabled="True" TickFrequency="1"/>
                    
                    <!-- Default Window Width -->
                    <TextBlock Style="{StaticResource SettingLabel}">
                        <Run Text="{loc:Localize DefaultWidth}"/>
                        <Run Text=": "/>
                        <Run x:Name="WidthValue" Text="320"/>
                    </TextBlock>
                    <Slider x:Name="WidthSlider" Style="{StaticResource SettingSlider}"
                            Minimum="200" Maximum="600" Value="320"
                            ValueChanged="WidthSlider_ValueChanged"
                            IsSnapToTickEnabled="True" TickFrequency="10"/>
                    
                    <!-- Default Window Height -->
                    <TextBlock Style="{StaticResource SettingLabel}">
                        <Run Text="{loc:Localize DefaultHeight}"/>
                        <Run Text=": "/>
                        <Run x:Name="HeightValue" Text="220"/>
                    </TextBlock>
                    <Slider x:Name="HeightSlider" Style="{StaticResource SettingSlider}"
                            Minimum="150" Maximum="500" Value="220"
                            ValueChanged="HeightSlider_ValueChanged"
                            IsSnapToTickEnabled="True" TickFrequency="10"/>
                    
                    <!-- Auto-save Delay -->
                    <TextBlock Style="{StaticResource SettingLabel}">
                        <Run Text="{loc:Localize AutoSaveDelay}"/>
                        <Run Text=": "/>
                        <Run x:Name="AutoSaveValue" Text="500"/>
                        <Run Text=" ms"/>
                    </TextBlock>
                    <Slider x:Name="AutoSaveSlider" Style="{StaticResource SettingSlider}"
                            Minimum="100" Maximum="2000" Value="500"
                            ValueChanged="AutoSaveSlider_ValueChanged"
                            IsSnapToTickEnabled="True" TickFrequency="100"/>
                    
                    <!-- Language -->
                    <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize Language}"/>
                    <ComboBox x:Name="LanguageCombo" Margin="0,0,0,16"
                              SelectionChanged="LanguageCombo_SelectionChanged">
                        <ComboBox.Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Background" Value="{DynamicResource Surface1Brush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBox">
                                            <Grid>
                                                <ToggleButton x:Name="ToggleButton" 
                                                              Background="{DynamicResource Surface1Brush}"
                                                              BorderThickness="0" Focusable="False"
                                                              IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                                    <ToggleButton.Template>
                                                        <ControlTemplate TargetType="ToggleButton">
                                                            <Border x:Name="bd" Background="{TemplateBinding Background}" 
                                                                    CornerRadius="4" Padding="12,8">
                                                                <Grid>
                                                                    <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False"
                                                                                      Content="{TemplateBinding Content}"
                                                                                      HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                                    <TextBlock Text="â–¾" HorizontalAlignment="Right" 
                                                                               Foreground="{DynamicResource SubtextBrush}" VerticalAlignment="Center"/>
                                                                </Grid>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </ToggleButton.Template>
                                                    <ContentPresenter Content="{TemplateBinding SelectionBoxItem}"
                                                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"/>
                                                </ToggleButton>
                                                <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}"
                                                       AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                                    <Border Background="{DynamicResource Surface0Brush}" 
                                                            BorderBrush="{DynamicResource Surface1Brush}" 
                                                            BorderThickness="1" CornerRadius="4" Margin="0,2,0,0">
                                                        <ItemsPresenter/>
                                                    </Border>
                                                </Popup>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.Style>
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                <Setter Property="Padding" Value="12,8"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBoxItem">
                                            <Border x:Name="bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface1Brush}"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.ItemContainerStyle>
                        <ComboBoxItem Content="English" Tag="en"/>
                        <ComboBoxItem Content="Tiáº¿ng Viá»‡t" Tag="vi"/>
                    </ComboBox>
                    
                    <!-- Theme -->
                    <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize Theme}"/>
                    <ComboBox x:Name="ThemeCombo" Margin="0,0,0,16"
                              SelectionChanged="ThemeCombo_SelectionChanged">
                        <ComboBox.Style>
                            <Style TargetType="ComboBox">
                                <Setter Property="Background" Value="{DynamicResource Surface1Brush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBox">
                                            <Grid>
                                                <ToggleButton x:Name="ToggleButton" 
                                                              Background="{DynamicResource Surface1Brush}"
                                                              BorderThickness="0" Focusable="False"
                                                              IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                                    <ToggleButton.Template>
                                                        <ControlTemplate TargetType="ToggleButton">
                                                            <Border x:Name="bd" Background="{TemplateBinding Background}" 
                                                                    CornerRadius="4" Padding="12,8">
                                                                <Grid>
                                                                    <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False"
                                                                                      Content="{TemplateBinding Content}"
                                                                                      HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                                    <TextBlock Text="â–¾" HorizontalAlignment="Right" 
                                                                               Foreground="{DynamicResource SubtextBrush}" VerticalAlignment="Center"/>
                                                                </Grid>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </ToggleButton.Template>
                                                    <ContentPresenter Content="{TemplateBinding SelectionBoxItem}"
                                                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"/>
                                                </ToggleButton>
                                                <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}"
                                                       AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                                    <Border Background="{DynamicResource Surface0Brush}" 
                                                            BorderBrush="{DynamicResource Surface1Brush}" 
                                                            BorderThickness="1" CornerRadius="4" Margin="0,2,0,0">
                                                        <ItemsPresenter/>
                                                    </Border>
                                                </Popup>
                                            </Grid>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.Style>
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                <Setter Property="Padding" Value="12,8"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ComboBoxItem">
                                            <Border x:Name="bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                                <ContentPresenter/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface1Brush}"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ComboBox.ItemContainerStyle>
                        <ComboBoxItem Content="{loc:Localize ThemeLight}" Tag="Light"/>
                        <ComboBoxItem Content="{loc:Localize ThemeDark}" Tag="Dark"/>
                        <ComboBoxItem Content="{loc:Localize ThemeSystem}" Tag="System"/>
                    </ComboBox>
                    
                    <!-- Hotkeys Section -->
                    <Border BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="0,1,0,0" 
                            Padding="0,16,0,0" Margin="0,8,0,0">
                        <StackPanel>
                            <TextBlock Text="{loc:Localize Hotkeys}" Style="{StaticResource SettingLabel}" 
                                       FontWeight="SemiBold" Margin="0,0,0,12"/>
                            
                            <!-- New Note Hotkey -->
                            <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize NewNoteHotkey}"/>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="NewNoteHotkeyBox" Grid.Column="0" IsReadOnly="True"
                                         Style="{StaticResource InputBox}"
                                         PreviewKeyDown="HotkeyBox_PreviewKeyDown"
                                         GotFocus="HotkeyBox_GotFocus"
                                         LostFocus="HotkeyBox_LostFocus"/>
                                <Button Grid.Column="1" Content="âœ•" Width="28" Height="28" Margin="4,0,0,0"
                                        Style="{StaticResource IconBtn}" 
                                        Click="ClearNewNoteHotkey_Click"/>
                            </Grid>
                            
                            <!-- Toggle Visibility Hotkey -->
                            <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize ToggleVisibilityHotkey}"/>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="ToggleVisibilityHotkeyBox" Grid.Column="0" IsReadOnly="True"
                                         Style="{StaticResource InputBox}"
                                         PreviewKeyDown="HotkeyBox_PreviewKeyDown"
                                         GotFocus="HotkeyBox_GotFocus"
                                         LostFocus="HotkeyBox_LostFocus"/>
                                <Button Grid.Column="1" Content="âœ•" Width="28" Height="28" Margin="4,0,0,0"
                                        Style="{StaticResource IconBtn}" 
                                        Click="ClearToggleVisibilityHotkey_Click"/>
                            </Grid>
                            
                            <!-- Quick Capture Hotkey -->
                            <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize QuickCaptureHotkey}"/>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="QuickCaptureHotkeyBox" Grid.Column="0" IsReadOnly="True"
                                         Style="{StaticResource InputBox}"
                                         PreviewKeyDown="HotkeyBox_PreviewKeyDown"
                                         GotFocus="HotkeyBox_GotFocus"
                                         LostFocus="HotkeyBox_LostFocus"/>
                                <Button Grid.Column="1" Content="âœ•" Width="28" Height="28" Margin="4,0,0,0"
                                        Style="{StaticResource IconBtn}" 
                                        Click="ClearQuickCaptureHotkey_Click"/>
                            </Grid>
                            
                            <TextBlock Text="{loc:Localize HotkeyHint}" Foreground="{DynamicResource SubtextBrush}" 
                                       FontSize="11" TextWrapping="Wrap" Margin="0,0,0,8"/>
                            
                            <!-- Hotkey status indicator -->
                            <TextBlock x:Name="HotkeyStatusText" Foreground="{DynamicResource SubtextBrush}" 
                                       FontSize="11" TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Cloud Sync Section (Requirements 5.1, 5.10, 5.11) -->
                    <Border BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="0,1,0,0" 
                            Padding="0,16,0,0" Margin="0,8,0,0">
                        <StackPanel>
                            <TextBlock Text="{loc:Localize CloudSync}" Style="{StaticResource SettingLabel}" 
                                       FontWeight="SemiBold" Margin="0,0,0,12"/>
                            
                            <!-- Cloud Provider Selection -->
                            <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize CloudProvider}"/>
                            <ComboBox x:Name="CloudProviderCombo" Margin="0,0,0,12"
                                      SelectionChanged="CloudProviderCombo_SelectionChanged">
                                <ComboBox.Style>
                                    <Style TargetType="ComboBox">
                                        <Setter Property="Background" Value="{DynamicResource Surface1Brush}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ComboBox">
                                                    <Grid>
                                                        <ToggleButton x:Name="ToggleButton" 
                                                                      Background="{DynamicResource Surface1Brush}"
                                                                      BorderThickness="0" Focusable="False"
                                                                      IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                                            <ToggleButton.Template>
                                                                <ControlTemplate TargetType="ToggleButton">
                                                                    <Border x:Name="bd" Background="{TemplateBinding Background}" 
                                                                            CornerRadius="4" Padding="12,8">
                                                                        <Grid>
                                                                            <ContentPresenter x:Name="ContentSite" IsHitTestVisible="False"
                                                                                              Content="{TemplateBinding Content}"
                                                                                              HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                                                            <TextBlock Text="â–¾" HorizontalAlignment="Right" 
                                                                                       Foreground="{DynamicResource SubtextBrush}" VerticalAlignment="Center"/>
                                                                        </Grid>
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </ToggleButton.Template>
                                                            <ContentPresenter Content="{TemplateBinding SelectionBoxItem}"
                                                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"/>
                                                        </ToggleButton>
                                                        <Popup x:Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}"
                                                               AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                                                            <Border Background="{DynamicResource Surface0Brush}" 
                                                                    BorderBrush="{DynamicResource Surface1Brush}" 
                                                                    BorderThickness="1" CornerRadius="4" Margin="0,2,0,0">
                                                                <ItemsPresenter/>
                                                            </Border>
                                                        </Popup>
                                                    </Grid>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ComboBox.Style>
                                <ComboBox.ItemContainerStyle>
                                    <Style TargetType="ComboBoxItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                                        <Setter Property="Padding" Value="12,8"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ComboBoxItem">
                                                    <Border x:Name="bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface1Brush}"/>
                                                        </Trigger>
                                                        <Trigger Property="IsSelected" Value="True">
                                                            <Setter TargetName="bd" Property="Background" Value="{DynamicResource Surface2Brush}"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                                <ComboBoxItem Content="{loc:Localize CloudProviderNone}" Tag="None"/>
                                <ComboBoxItem Content="OneDrive" Tag="OneDrive"/>
                                <ComboBoxItem Content="Google Drive" Tag="GoogleDrive"/>
                            </ComboBox>
                            
                            <!-- Connect/Disconnect Button -->
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="CloudStatusText" Grid.Column="0" 
                                           Foreground="{DynamicResource SubtextBrush}" 
                                           FontSize="12" VerticalAlignment="Center"
                                           Text="{loc:Localize CloudStatusDisconnected}"/>
                                <Button x:Name="CloudConnectBtn" Grid.Column="1" 
                                        Content="{loc:Localize CloudConnect}" 
                                        Style="{StaticResource ActionBtn}" 
                                        Click="CloudConnectBtn_Click" Padding="16,8"/>
                            </Grid>
                            
                            <!-- Encryption Passphrase (Requirements 5.11) -->
                            <TextBlock Style="{StaticResource SettingLabel}" Text="{loc:Localize EncryptionPassphrase}"/>
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <PasswordBox x:Name="EncryptionPassphraseBox" Grid.Column="0"
                                             Background="{DynamicResource Surface1Brush}" 
                                             Foreground="{DynamicResource TextBrush}"
                                             BorderThickness="0" Padding="8,6"
                                             PasswordChanged="EncryptionPassphraseBox_PasswordChanged"/>
                                <Button Grid.Column="1" Content="ðŸ‘" Width="28" Height="28" Margin="4,0,0,0"
                                        Style="{StaticResource IconBtn}" 
                                        Click="TogglePassphraseVisibility_Click"
                                        ToolTip="{loc:Localize ShowPassword}"/>
                            </Grid>
                            <TextBlock Text="{loc:Localize EncryptionHint}" Foreground="{DynamicResource SubtextBrush}" 
                                       FontSize="11" TextWrapping="Wrap" Margin="0,0,0,12"/>
                            
                            <!-- Sync Interval -->
                            <TextBlock Style="{StaticResource SettingLabel}">
                                <Run Text="{loc:Localize SyncInterval}"/>
                                <Run Text=": "/>
                                <Run x:Name="SyncIntervalValue" Text="5"/>
                                <Run Text=" "/>
                                <Run Text="{loc:Localize Minutes}"/>
                            </TextBlock>
                            <Slider x:Name="SyncIntervalSlider" Style="{StaticResource SettingSlider}"
                                    Minimum="1" Maximum="60" Value="5"
                                    ValueChanged="SyncIntervalSlider_ValueChanged"
                                    IsSnapToTickEnabled="True" TickFrequency="1"/>
                            
                            <!-- Sync Status Indicator -->
                            <TextBlock x:Name="CloudSyncStatusText" Foreground="{DynamicResource SubtextBrush}" 
                                       FontSize="11" TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Backup & Restore Section -->
                    <Border BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="0,1,0,0" 
                            Padding="0,16,0,0" Margin="0,8,0,0">
                        <StackPanel>
                            <TextBlock Text="{loc:Localize BackupRestore}" Style="{StaticResource SettingLabel}" 
                                       FontWeight="SemiBold" Margin="0,0,0,12"/>
                            
                            <!-- Auto Backup Toggle -->
                            <Grid Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{loc:Localize AutoBackup}" 
                                           Style="{StaticResource SettingLabel}" VerticalAlignment="Center" Margin="0"/>
                                <CheckBox x:Name="AutoBackupCheckBox" Grid.Column="1" 
                                          Checked="AutoBackupCheckBox_Changed" Unchecked="AutoBackupCheckBox_Changed"/>
                            </Grid>
                            
                            <!-- Backup Interval -->
                            <TextBlock Style="{StaticResource SettingLabel}">
                                <Run Text="{loc:Localize BackupInterval}"/>
                                <Run Text=": "/>
                                <Run x:Name="BackupIntervalValue" Text="30"/>
                                <Run Text=" "/>
                                <Run Text="{loc:Localize Minutes}"/>
                            </TextBlock>
                            <Slider x:Name="BackupIntervalSlider" Style="{StaticResource SettingSlider}"
                                    Minimum="5" Maximum="120" Value="30"
                                    ValueChanged="BackupIntervalSlider_ValueChanged"
                                    IsSnapToTickEnabled="True" TickFrequency="5"/>
                            
                            <!-- Max Backups -->
                            <TextBlock Style="{StaticResource SettingLabel}">
                                <Run Text="{loc:Localize MaxBackups}"/>
                                <Run Text=": "/>
                                <Run x:Name="MaxBackupsValue" Text="10"/>
                            </TextBlock>
                            <Slider x:Name="MaxBackupsSlider" Style="{StaticResource SettingSlider}"
                                    Minimum="3" Maximum="30" Value="10"
                                    ValueChanged="MaxBackupsSlider_ValueChanged"
                                    IsSnapToTickEnabled="True" TickFrequency="1"/>
                            
                            <!-- Backup Actions -->
                            <StackPanel Orientation="Horizontal" Margin="0,8,0,8">
                                <Button Content="{loc:Localize BackupNow}" Style="{StaticResource ActionBtn}" 
                                        Click="BtnBackupNow_Click" Padding="16,8" Margin="0,0,8,0"/>
                                <Button Content="{loc:Localize RestoreBackup}" Style="{StaticResource ActionBtn}" 
                                        Click="BtnRestoreBackup_Click" Padding="16,8"/>
                            </StackPanel>
                            
                            <!-- Backup Status -->
                            <TextBlock x:Name="BackupStatusText" Foreground="{DynamicResource SubtextBrush}" 
                                       FontSize="11" TextWrapping="Wrap" Margin="0,0,0,12"/>
                            
                            <!-- Export/Import -->
                            <TextBlock Text="{loc:Localize ManualBackup}" Style="{StaticResource SettingLabel}" 
                                       Margin="0,8,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <Button Content="{loc:Localize ExportData}" Style="{StaticResource ActionBtn}" 
                                        Click="BtnExport_Click" Padding="16,8" Margin="0,0,8,0"/>
                                <Button Content="{loc:Localize ImportData}" Style="{StaticResource ActionBtn}" 
                                        Click="BtnImport_Click" Padding="16,8"/>
                            </StackPanel>
                            
                            <TextBlock Text="{loc:Localize BackupHint}" Foreground="{DynamicResource SubtextBrush}" 
                                       FontSize="11" TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Footer -->
            <Border Grid.Row="2" Background="{DynamicResource Surface0Brush}" CornerRadius="0,0,8,8">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" 
                            VerticalAlignment="Center" Margin="16,0">
                    <Button Content="{loc:Localize Cancel}" Style="{StaticResource ActionBtn}" 
                            Click="BtnCancel_Click" Margin="0,0,8,0"/>
                    <Button Content="{loc:Localize Save}" Style="{StaticResource PrimaryBtn}" 
                            Click="BtnSave_Click"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</Window>
