<Window x:Class="DevSticky.Views.CrashErrorDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:loc="clr-namespace:DevSticky.Services"
        Title="DevSticky - Application Error"
        Width="600" Height="700" 
        WindowStartupLocation="CenterScreen"
        WindowStyle="SingleBorderWindow"
        ResizeMode="CanResize"
        ShowInTaskbar="True"
        Icon="/Resources/app.ico">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/SharedStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Custom styles for the error dialog -->
            <Style x:Key="ErrorHeaderStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Foreground" Value="#F38BA8"/>
                <Setter Property="Margin" Value="0,0,0,10"/>
            </Style>
            
            <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
                <Setter Property="Margin" Value="0,15,0,8"/>
            </Style>
            
            <Style x:Key="InfoTextStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="Foreground" Value="{DynamicResource SubtleBrush}"/>
                <Setter Property="TextWrapping" Value="Wrap"/>
                <Setter Property="LineHeight" Value="18"/>
            </Style>
            
            <Style x:Key="ActionButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryBtn}">
                <Setter Property="Margin" Value="0,0,10,0"/>
                <Setter Property="Padding" Value="16,8"/>
                <Setter Property="MinWidth" Value="120"/>
            </Style>
            
            <Style x:Key="SecondaryActionButtonStyle" TargetType="Button" BasedOn="{StaticResource DialogBtn}">
                <Setter Property="Margin" Value="0,0,10,0"/>
                <Setter Property="Padding" Value="16,8"/>
                <Setter Property="MinWidth" Value="120"/>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid Background="{DynamicResource BaseBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{DynamicResource Surface0Brush}" 
                BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="0,0,0,1"
                Padding="20,16">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="❌" FontSize="24" Margin="0,0,12,0" VerticalAlignment="Center"/>
                <StackPanel>
                    <TextBlock Style="{StaticResource ErrorHeaderStyle}" Text="Application Startup Error"/>
                    <TextBlock Style="{StaticResource InfoTextStyle}" 
                               Text="DevSticky encountered an error during startup and needs to close."/>
                </StackPanel>
            </StackPanel>
        </Border>
        
        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="20">
            <StackPanel>
                
                <!-- Error Summary -->
                <TextBlock Style="{StaticResource SectionHeaderStyle}" Text="Error Summary"/>
                <Border Background="{DynamicResource Surface0Brush}" 
                        BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="1"
                        CornerRadius="4" Padding="12" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock x:Name="ErrorTypeText" FontWeight="SemiBold" 
                                   Foreground="{DynamicResource TextBrush}" Margin="0,0,0,4"/>
                        <TextBlock x:Name="ErrorMessageText" Style="{StaticResource InfoTextStyle}"/>
                        <TextBlock x:Name="ComponentText" Style="{StaticResource InfoTextStyle}" 
                                   Margin="0,8,0,0" FontStyle="Italic"/>
                    </StackPanel>
                </Border>
                
                <!-- Quick Actions -->
                <TextBlock Style="{StaticResource SectionHeaderStyle}" Text="Quick Actions"/>
                <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,10"
                           Text="Try these solutions to resolve the issue:"/>
                
                <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                    <Button x:Name="SafeModeButton" Style="{StaticResource ActionButtonStyle}"
                            Content="Start in Safe Mode" Click="SafeModeButton_Click"
                            ToolTip="Start DevSticky with minimal features to bypass startup issues"/>
                    <Button x:Name="ResetConfigButton" Style="{StaticResource SecondaryActionButtonStyle}"
                            Content="Reset Configuration" Click="ResetConfigButton_Click"
                            ToolTip="Reset all settings to default values"/>
                </StackPanel>
                
                <!-- Troubleshooting Information -->
                <TextBlock Style="{StaticResource SectionHeaderStyle}" Text="Troubleshooting Steps"/>
                <Border Background="{DynamicResource Surface0Brush}" 
                        BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="1"
                        CornerRadius="4" Padding="12" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,8">
                            <Run Text="1. "/>
                            <Run FontWeight="SemiBold" Text="Safe Mode:"/>
                            <Run Text=" Click 'Start in Safe Mode' to launch with minimal features."/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,8">
                            <Run Text="2. "/>
                            <Run FontWeight="SemiBold" Text="Reset Configuration:"/>
                            <Run Text=" Reset all settings to defaults if configuration is corrupted."/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,8">
                            <Run Text="3. "/>
                            <Run FontWeight="SemiBold" Text="Check Dependencies:"/>
                            <Run Text=" Ensure .NET runtime and required components are installed."/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,8">
                            <Run Text="4. "/>
                            <Run FontWeight="SemiBold" Text="Restart as Administrator:"/>
                            <Run Text=" Some operations may require elevated permissions."/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}">
                            <Run Text="5. "/>
                            <Run FontWeight="SemiBold" Text="Contact Support:"/>
                            <Run Text=" If the issue persists, export diagnostic information and contact support."/>
                        </TextBlock>
                    </StackPanel>
                </Border>
                
                <!-- Diagnostic Information -->
                <TextBlock Style="{StaticResource SectionHeaderStyle}" Text="Diagnostic Information"/>
                <Border Background="{DynamicResource Surface0Brush}" 
                        BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="1"
                        CornerRadius="4" Margin="0,0,0,15">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Diagnostic Header -->
                        <Border Grid.Row="0" Background="{DynamicResource Surface1Brush}" 
                                Padding="12,8" CornerRadius="4,4,0,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Technical Details" FontWeight="SemiBold" 
                                           Foreground="{DynamicResource TextBrush}" VerticalAlignment="Center"/>
                                <Button x:Name="ExportDiagnosticsButton" 
                                        Content="Export" Margin="10,0,0,0" Padding="8,4"
                                        Style="{StaticResource DialogBtn}" FontSize="11"
                                        Click="ExportDiagnosticsButton_Click"
                                        ToolTip="Export diagnostic information to file"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Diagnostic Content -->
                        <ScrollViewer Grid.Row="1" MaxHeight="200" VerticalScrollBarVisibility="Auto">
                            <TextBox x:Name="DiagnosticTextBox" 
                                     Background="Transparent" BorderThickness="0"
                                     Foreground="{DynamicResource SubtleBrush}"
                                     FontFamily="Consolas" FontSize="10"
                                     IsReadOnly="True" TextWrapping="Wrap"
                                     Padding="12" Margin="0"/>
                        </ScrollViewer>
                    </Grid>
                </Border>
                
                <!-- Contact Information -->
                <TextBlock Style="{StaticResource SectionHeaderStyle}" Text="Need Help?"/>
                <Border Background="{DynamicResource Surface0Brush}" 
                        BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="1"
                        CornerRadius="4" Padding="12">
                    <StackPanel>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,8">
                            <Run Text="If you continue experiencing issues, please:"/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,4">
                            <Run Text="• Export the diagnostic information above"/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,4">
                            <Run Text="• Visit our GitHub repository: "/>
                            <Hyperlink x:Name="GitHubLink" Click="GitHubLink_Click" 
                                       Foreground="{DynamicResource AccentBrush}">
                                https://github.com/devsticky/devsticky
                            </Hyperlink>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}" Margin="0,0,0,4">
                            <Run Text="• Create an issue with the diagnostic information"/>
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoTextStyle}">
                            <Run Text="• Include steps to reproduce the problem"/>
                        </TextBlock>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Footer Actions -->
        <Border Grid.Row="2" Background="{DynamicResource Surface0Brush}" 
                BorderBrush="{DynamicResource Surface1Brush}" BorderThickness="0,1,0,0"
                Padding="20,12">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="TryAgainButton" Style="{StaticResource SecondaryActionButtonStyle}"
                        Content="Try Again" Click="TryAgainButton_Click"
                        ToolTip="Attempt to restart DevSticky normally"/>
                <Button x:Name="CloseButton" Style="{StaticResource ActionButtonStyle}"
                        Content="Close" Click="CloseButton_Click" IsDefault="True"/>
            </StackPanel>
        </Border>
        
    </Grid>
</Window>